{% extends "main.html" %}
    {% block scripts %}
    <script type="text/javascript">
        $(function () {
            $(".rank-link").click(function () {
                var dataId = $(this).attr("data-id");
                var id = $(this).attr('id');
                if (dataId == id + "-up") {
                    id = id + "-down";
                    $("a[data-id=" + id + "]").attr("class", "rank-link not-active");
                }
                if (dataId == id + "-down") {
                    id = id + "-up";
                    $("a[data-id=" + id + "]").attr("class", "rank-link not-active");
                }
                $(this).toggleClass("not-active active");
                $.ajax({
                    type: "PUT",
                    url: $(this).attr("href")
                });
                return false;
            });
            $(".delete-post").click(function () {
                var dataId = $(this).attr("data-id");
                var parentDiv = $("#" + dataId);
                var confirm = "<div class='confirm' id='" + dataId +"-confirm'><a href=''>Delete?</a>  <a href=''>Keep!</a></div>";
                newHeight = parentDiv.height();
                parentDiv.after(confirm);
                $("#" + dataId + "-confirm").css("height", newHeight + "px").css("line-height", (newHeight) + "px" );
                parentDiv.hide();
                if (false) {
                    $.ajax({
                    type: "DELETE",
                    url: $(this).attr("href")
                    });
                }
                return false;
            });
        });
    </script>
    {% endblock %}
    {% block body %}
        <div id="dialog-confirm"></div>
        {% for post in posts %}
            <div class="pure-g" id="{{ post.pk }}">
                <div class="pure-u-3-8 title-information">
                    <div class="pure-g">
                       <div class="pure-u-1-1 title">
                           {{ post.title }}
                       </div>
                       <div class="pure-u-1-1 date">
                           {{ post.date }}
                       </div>
                       <div class="pure-u-1-1 rank">
                           <a href="/rank/{{ post.pk }}/1/" data-id="{{ post.pk }}-up" id="{{ post.pk }}" class="rank-link {{ post.up_active }}">▲</a>
                       </div>
                       <div class="pure-u-1-1 rank">
                           <a href="/rank/{{ post.pk }}/-1/" data-id="{{ post.pk }}-down" id="{{ post.pk }}" class="rank-link {{ post.down_active }}">▼</a>
                       </div>
                    </div>
                </div>
                <div class="pure-u-5-8 content">
                    {{ post.content }}
                </div>
                <div class="pure-u-1-1 post-actions">
                    <a href="/posts/{{ post.pk }}/" class="delete-post" data-id="{{ post.pk }}">delete</a> <a href="/edit/{{ post.pk }}/" class="edit-post">edit</a> <a href="/post/{{ post.pk }}/" class="rank-post">rank</a>
                </div>
            </div>
        {% endfor %}
{% endblock %}